## contents

[toc]



# 概述

<img src="https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230409164312859.png" alt="shadow-image-20230409164312859" style="zoom:50%;" />

<img src="https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230409164326343.png" alt="shadow-image-20230409164326343" style="zoom:50%;" />

## 基本概念

### 计算机系统结构定义

经典定义：概念性结构与功能特性

广义定义：指令系统结构、组成、硬件

实质：确定计算机系统中的软硬件界面，界面之上是软件实现的功能，界面之下是硬件和固件实现的功能

### 计算机组成和实现

1. 计算机系统结构：计算机的软硬件界面
2. 计算机组成：计算机系统结果的逻辑实现
   - 物理机器级中的数据流、控制流的组成
   - 着眼于：物理机器内各种事件的排序与控制方式、各部件的功能和联系
3. 计算机实现：计算机组成的物理实现
   - 处理机、主存的物理结构，器件的集成度与速度……
   - 着眼于：器件技术、微组装技术

![shadow-image-20230409145615433](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230409145615433.png)

### 系统结构分类

1. Flynn 分类法，根据指令流和数据流

   - 指令流
   - 数据流
   - 多倍性：SISD，SIMD，MISD，MIMD

2. 冯氏分类法，根据最大并行度（字宽、位宽）

   - 最大并行度

   - 字串位串

   - 字串位并

   - ……

3. Handler 分类法，根据并行度和流水线

## 计算机系统设计

### 定量原理

1. 以经常性事件为重点

2. Amdahl 定律：加快某部件执行速度所能获得的系统性能加速比，受限于该部件执行时间占系统中总执行时间的百分比

   - 系统性能加速比  $加速比=\frac{改进后执行时间}{改进前执行时间}$

   - 依赖于两个因素

     - 可改进比例 $F_e$：改进前的系统中，可改进部分的执行时间在总执行时间中所占的比例

     - 部件加速比 $S_e$：可改进部分改进一会性能提高的倍数（改进前所需执行时间与改进后执行时间的比）

     - ==改进后的程序总执行时间==

     - $$
       T_n=T_0\left(1-F e+\frac{F e}{S e}\right)
       $$

     - ==系统加速比为改进前与改进后总执行时间之比==
     - $$
     S_n=\frac{T_0}{T_n}=\frac{1}{(1-F e)+\frac{F e}{S e}}
     $$

   - <img src="https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230409152041808.png" alt="shadow-image-20230409152041808" style="zoom:50%;" />

   - 仅对计算机中的一部分性能改进，则改进越多，所得到的总性能提升就越有限，最后所得加速比不超过 $\frac{1}{1-Fe}$

3. CPU 性能公式

   - CPU 时间=执行程序所需要时钟周期数×时钟周期时间
   - CPU 性能取决于三个参数
     1. 时钟周期时间：取决于硬件和计算机组成
     2. 指令平均时钟周期数==CPI==：取决于计算机组成和指令系统结构
     3. 所执行指令条数==IC==：取决于指令系统的结构和编译技术

4. 程序的局部性原理

   - 经验规则：程序 90%的时间在执行 10%的代码
   - 时间局部性：即将用到的信息很可能就是目前使用的信息
   - 空间局部性：即将用到的信息很可能与目前正在使用的信息在空间上相邻或接近

## 计算机系统性能测评

1. 单个程序执行时间 Execution time

2. 响应时间：完成一个任务的全部时间

3. 吞吐率：单位时间内完成的任务数

4. MIPS：每秒处理的百万条指令数
	$$
   M I P S=\frac{\text { 指令条数 }}{\text { 执行时间 } \times 10^6}=\frac{f}{C P I \times 10^6}
   $$

### 性能比较

1. 总执行时间

2. 平均执行时间：各测试程序执行时间的算术平均值

3. 加权执行时间

4. 调和平均值：如果性能用速度表示（如 MFLOPS），可以用调和平均值

   - 倒数的算数平均的倒数

   - $$
     H_m=\frac{n}{\sum_{i=1}^n \frac{1}{R_i}}=\frac{n}{\sum_{i=1}^n T_i}
     $$

5. 几何平均值：

   - $$
     G_m=\sqrt[n]{\prod_{i=1}^n R_i}=\sqrt[n]{\prod_{i=1}^n \frac{1}{T_i}}
     $$

## 计算机系统结构发展



## 并行性的发展

### 概念

1. 并行性：计算机系统在同一时刻或者同一时间间隔内进行多种运算或操作
   1. 同时性：多个时间在同一时刻发生
   2. 并发性：多个时间在同一时间间隔内发生
2. 从处理数据的角度看，并行性等级划分
   - 字串位串：每次只对一个字的一位进行处理
   - 字串位并：同时对一个字的全部位进行处理
   - 字并位串：同时对许多字的同一位（位片）进行处理
   - 全并行
3. 从执行程序的角度看，并行性等级划分：
   - 指令内部并行：指令中微操作之间并行
   - 指令级并行：并行执行多条指令
   - 线程级并行：并行执行多个线程，*以线程为调度单位*
   - 任务级或过程级并行：并行执行多个过程或任务（程序段），*以子程序或进程为调度单位*
   - 作业或程序级并行

### 提高并行性的途径

1. 时间重叠
2. 资源重复
3. 资源共享

#### 时间重叠

实现时间重叠的基础：部件功能专门化

- 把一个工作分割为若干部分
- 每一部分交给专门的部件完成
- 执行过程在时间上重叠起来



#### 资源重复

