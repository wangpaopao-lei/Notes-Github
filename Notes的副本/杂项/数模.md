1. canny提取粗像素 x
2. 插值得到精确亚像素 x
3. 计算总轮廓数、总长度 x 

4. 单个轮廓长度、像素点数、点坐标  x
![](image/2021-11-27-19-15-40.png)
5. 点阵校准分析（参考论文）
![](image/2021-11-28-00-09-38.png)
到底是畸变分析还是旋转分析？
6. 像素当量标度模型（像素/mm）x
   ![](image/2021-11-27-17-50-06.png)
   ![](image/2021-11-27-19-13-03.png)
   ![](image/2021-11-27-19-15-20.png)
7. 计算轮廓边缘长度（mm）（根据像素点长度求）
8. **图形的分割拟合**
![](image/2021-11-28-00-57-30.png)

问题2

这一问也可以当做摄像机标定和畸变校正，处理上大概有两种方法

一种是利用Matlab和OpenCV,标定板使用提供的图片即可

参考：https://www.cnblogs.com/czaoth/p/6708653.html

另外也可以利用Halcon软件进行畸变矫正

参考：https://blog.csdn.net/ab1271173712/article/details/78134277

https://blog.csdn.net/yue1453544229/article/details/106867955

进行矫正后，由于校准板和目标产品在同一水平高度，已知校准板的真实大小数据、照片上目标产品边缘分割拟合曲线段的长度，即可计算图像的实际边缘距离。

关于曲线段的长度，还是利用问题一的边缘提取模型计算。

这一部分看起来有点绕，找到合适的工具软件比较有帮助。

 

问题三

这一问其实是曲线自动分割并拟合成直线、圆的方法（而不是分割图像），属于图像和几何学的范畴，同样也可以利用Halcon库。

可以先实现算法，毕竟这道题目算出精确结果是最重要的，之后可以再补充结果。如Halcon库中轮廓分割使用了Ramer-Douglas-Peucker算法。该算法的思想为，给定一条由若干线段组成的曲线，找出包含的点数少且外观相近的曲线。通过这个算法，可以寻找近似的算法，再加以使用改进。

（1）、segment_contours_xld首先通过折线来逼近输入的轮廓，这样，在弯曲的地方轮廓就会被过度的分割，如果用圆弧可以更好地逼近轮廓，则用圆弧或椭圆弧分别代替相邻的线段。如果SmoothCont设置为> 0，则首先对输入的轮廓进行平滑，这是必要的，因为平滑抑制了轮廓上的异常值，所以一方面可以防止在分割特别短的线的时后带来的异常，另一方面，在使用圆或椭圆分割时，可以实现更稳健的分割；
（2）、最初的折线逼近是使用Ramer算法（对每一条曲线的首末点虚连一条直线,求所有点与直线的距离,并找出最大距离值dmax ,用dmax与限差D相比:若dmax D,这条曲线上的中间点全部舍去;若dmax ≥D,保留dmax 对应的坐标点,并以该点为界,把曲线分为两部分,对这两部分重复使用该方法。）通过MaxLineDist1的最大距离来完成的，在此之后，圆形或椭圆形的弧被匹配到相邻的线段中，如果所产生的弧线到轮廓线的最大距离小于两条线段的最大距离，两个线段被替换为圆弧，迭代此过程，直到不再发生更改；
（3）、在此之后，仍然由线段逼近的轮廓部分再次用最大距离MaxLineDist2的多边形逼近进行分割，并且新创建的线段在可能的情况下合并为圆形或椭圆弧。显然，这只会在MaxLineDist2 < MaxLineDist1时更改输出，这种两步方法比使用MaxLineDist2的一步方法更有效，由于在第一步中生成的线段较少，因此必须较少地进行圆或椭圆拟合。因此，使用长圆弧逼近部分输入轮廓会更高效；之后，再用短圆弧去逼近输入的轮廓，最后再细化使用过长圆弧逼近的轮廓的末端；
（4）、所述所得轮廓长度至少为3像素，并且包含所述输入轮廓的至少6个连续点；所有输入的长度小于3像素或少于6个轮廓点的轮廓线将被复制到输出轮廓线，不做任何修改。
$G(x,y)=\frac{1}{2\pi\sigma^2}e^{-\frac{x^2+y^2}{2\sigma^2}}$
$P_y(i,j)=\frac{I(i,j)-I(i+1,j)+I(i,j+1)-I(i+1,j+1)}{2}$
$M(i,j)=\sqrt{P_x(i,j)^2+P_y(i,j)^2}$
$\theta(i,j)=tan^{-1}\frac{P_y(i,j)}{P_x(i,j)}$
$P_n(x)=\sum_{y=1}^ny_i(\prod_{j\neq i}^{1\leqslant j\leqslant n}\frac{x-x_j}{x_i-x_j}$
$x=i+\frac{R_{left}-R_{right}}{R_{left}+R_{right}-2R_0}\cdot \frac{W}{2}\cdot cos(\theta)$
$y=i+\frac{R_{left}-R_{right}}{R_{left}+R_{right}-2R_0}\cdot \frac{W}{2}\cdot sin(\theta)$
$d=\left|\frac{Ax_0+By_0+C}{\sqrt{A^2+B^2}} \right| $
$SNR(f)=\frac{\left|\int_{-W}^WG(-x)f(x)dx\right|}{\delta\sqrt{\int_{-W}^{W}f^2(x)dx}}$
$Location=\frac{\left|\int_{-W}^WG'(-x)f'(x)dx\right|}{\delta\sqrt{\int_{-W}^{W}f'^2(x)dx}}$
$D(f')=\pi\left[\frac{\int_{\infty}^{\infty} f'^2(x)dx}{\sqrt{\int_{\infty}^{\infty} f(x)dx}}\right]$
$\frac{1}{2}(\frac{D}{A_r}-d$