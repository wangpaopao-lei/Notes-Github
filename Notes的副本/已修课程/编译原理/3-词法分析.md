## Content

[toc]

# 词法分析

![image-20230301095900559](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301095900559.png)

作用

1. 扫描源程序字符流
2. 按照源语言的词法规则识别出各类单词符号
3. 产生用于分析的记号序列
4. 词法检查
5. 与用户接口的一些任务
   - 跳过源程序中的注释和空白
   - 把错误信息和源程序联系起来
6. 创建符号表，把识别画出来 标识符插入符号表中

## 与语法分析的关系

三种关系

1. 词法分析作为独立的一遍
2. 词法分析作为语法分析的子程序
3. 词法分析作为语法分析的协同程序

![image-20230301100604691](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301100604691.png)

![image-20230301100611543](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301100611543.png)

![image-20230301100834484](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301100834484.png)

### 分离词法分析的好处

1. 简化设计：结构清晰、易于实现
2. 可以改进编译程序的效率：实用专门的读字符和处理记号的技术
3. 加强编译程序的可移植性

## 输入与输出

### 读入实现方法

1. 词法分析程序自动生成器
   1. 基于正规表达式的规范说明自动生成
   2. ==生成器提供==用于源程序字符流读入和缓冲的若干子程序
2. 使用传统的系统程序设计语言来编写
   1. 利用==该语言==具有的输入输出能力来处理读入
3. 利用汇编语言来编写
   1. ==直接管理==字符读入

#### 缓冲区的必要性

为了得到某个单词的确切性质，需要==超前扫描==

>如C 语言中，==、/*、//
>
>不超前扫描无法确定具体含义

#### 配对缓冲区

![image-20230301102113290](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301102113290.png)

单缓冲区可能出现一个单词读到一半的情况

### 输出：记号流

记号：某一类单词符号的类别编码，如标识符的记号为 id，常数的记号为 num

模式：

单词：

#### 记号的属性

记号影响语法分析的决策，属性影响记号的翻译（属性不影响语法分析）

在词法分析阶段，对记号只能确定一种属性

- 标识符：单词在符号表中的入口指针
- 常数：它表示的值
- 关键字、运算符、分界符：一符一种或一类一种

![image-20230301103148870](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230301103148870.png)

## 记号的描述和识别

识别**单词**是按照**记号**的==模式==进行，==一种记号的模式匹配一类单词的集合==

### 词法与正规文法

正规表达式与正规文法

 把源语言的文法 G 分解为若干子文法

- 词法：描述语言的标识符、常数、运算符、标点符号的文法（正规文法）
- 语法：借助于记号来描述语言的结构的文法（上下文无关文法）



## 词法分析程序的设计与实现

### 文法及状态转移图

1. 语言说明
2. 记号的正规文法
3. 状态转移图

#### 语言说明

![shadow-截屏2023-03-01 11.36.24](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/%E6%88%AA%E5%B1%8F2023-03-01%2011.36.24.png)

==记号的正规文法==

1. 标识符的文法![shadow-image-20230315175240679](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230315175240679.png)
2. 无符号整数的文法
3. 无符号数的文法
4. 关系运算符的文法
5. 赋值号的文法
6. 标点符号的文法
7. 注释头的文法

![shadow-image-20230315175458375](https://wangleidetuchuang.oss-cn-beijing.aliyuncs.com/img/image-20230315175458375.png)

### 词法分析程序的构造

把语义动作添加到状态转换图中，每一个状态对应一小段程序

- 某一个状态有若干射出边
  - 读一个字符
  - 根据读到的字符选择标记与之匹配的边到达下一个状态，即控制程序转去执行下一个状态对应的语句序列
- 在状态 0，首先要读进一个字符，如果是空字符（空格、tab、换行），就跳过，直到读入一个非空字符为止
- 在标识符状态，识别出一个标识符后，还必须加入一些动作，如查关键字表，以确定识别出的单词是关键字还是用户自定义标识符，并输出相应的记号





### 词法分析程序的实现

1. 输出形式
2. 设计全局变量和过程
3. 编制词法分析程序                                                                                                                                     



​                                                                                                              